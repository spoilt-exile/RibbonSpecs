<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Created on 6 серп 2013 14:48:20 -->

<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <title>
         Структура бази бази повідомлень
      </title>
      <meta name="GENERATOR" content="Arachnophilia 5.5"/>
      <meta name="FORMATTER" content="Arachnophilia 5.5"/>
      <link REL="stylesheet" type="text/css" href="../spec.css">
     	<meta charset="UTF-8" />
   </head>

<body>
<div class="main">
<div align="center" class="m-header">Структура бази бази повідомлень</div>
<br/>
<a href="_contents.html"><<<Назад</a>
<br/>
<br/>

<span class="header">Загальна структура</span><br/>
<br/>
Під час першого запуску, сервер за вказаним шляхом створює нову базу повідомлень, яку потім 
використовує. Файли цієї бази загалом реалізують формат CSV. <span class="red-text">Не варто редагувати файли 
бази повідомлень без поглиблених знань формату системи та структур даних (<span class="select">див. розділ 
Структури даних</span>).</span><br/>
<br/>


Структура бази повідомлень:
<pre class="code-frame">
КОРІНЬ/
└--export/ - тека зі схемами експорту повідомлень (<span class="select">див. розділ "Імпорт та експорт повідомлень"</span>);
|  └--<span class="green-text">*.export</span> - схеми експорту;
|  └--<span class="green-text">*.template</span> - шаблони експорту;
└--import/ - тека зі схемами імпорту повідомлень (<span class="select">див. розділ "Імпорт та експорт повідомлень"</span>);
|  └--<span class="green-text">*.import</span> - схеми імпорту;
└--ТЕКИ_НАПРЯМКІВ - див. нижче;
└--<span class="green-text">ФАЙЛИ_РАПОРТІВ</span> - див. нижче;
└--<span class="green-text">base.index</span> - індекс повідомлень у CSV-форматі;
└--<span class="green-text">dir.index</span> - індекс напрямків у CSV-форматі;
└--<span class="green-text">groups.index</span> - індекс груп користувачів у CSV-форматі;
└--<span class="green-text">pseudo.index</span> - індекс псевдонапрямків у CSV-форматі (якщо увімкнено видалений режим);
└--<span class="green-text">session.index</span> - індекс сесій користувачів у CSV-форматі (якщо увікнені сесії);
└--<span class="green-text">users.index</span> - індекс користувачів системи у CSV-форматі;
</pre><br/>


<span class="header">Теки напрямків</span><br/>
<br/>

При створенні бази повідомлень, сервер також створю дерево тек відповідно до існуючих напрямків. Тобто для напрямку 
<span class="code-text">Випуск.Сайт.Російська</span> система створить шлях з трьох тек, починаючи від кореня бази 
повідомлень: <span class="green-text">випуск/сайт/російська/</span>.<br/>
<br/>
Ця структура бази повідомлень схожа на структуру сервіса новинних повідомлень inn2. Така організація бази має свої 
переваги та недоліки. Найбільший недолік полягає у тому, що є обмеження на максимальну довжину шляху у системах *nix. 
<span class="strong">Неможна створювати напрямки з довжиною імені елемента більш ніж 255 літер (127 літер Юнікоду) і 
неможна створювати напрямки загальною довжиною біль ніж 4096 літер (2048 літер Юнікоду) від коріння файлової 
системи ОС.</span> Таке обмеження накладає віртуальна файлова система будь-якої з систем *nix. У системах Windows 
можна створювати напрямки загальною довжиною до 32 767 літер, але сервер не пристосований для роботи у середовищі 
Windows.<br/>
<br/>
Обмеження на загальну довжину напрямків планується обійти, пересунувши усі дані систему у базу даних.<br/>
<br/>

<span class="header">Файли рапортів</span><br/>
<br/>
Рапорти - це статичні текстові файли, які створюються під час запуску системи для перевірки параметрів та збору 
статистики. Поки що система створю лише один рапорт під назвою <span class="green-text">tree</span>, який 
показує структуру напрямків.

</div>
</body>
</html>
